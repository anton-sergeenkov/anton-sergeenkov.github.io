<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<link rel="icon" type="image/png" href="img/favicon.png">
	<link rel="stylesheet" type="text/css" href="css/main.css">
</head>
<body>
<div id="container">
<div id="menu-left">
	<div id="menu-left-starter">
		<div id="menu-left-show"></div>
		<a href="#menu-top">Starter</a>
	</div>

	<div class="theme">Замыкания</div>
	<a href="#2">Сумма произвольного кол-ва скобок</a>

	<div class="theme">Объекты</div>
	<a href="#1">Обращение к функции как к объекту</a>
	<a href="#4">Singleton ES5</a>
	<a href="#3">Singleton Class ES6</a>
	<a href="#5">Polyfill Object.create</a>
	<a href="#7">Polyfill Object.create (JSR)</a>
	<a href="#6">Prototype</a>
    
    <div class="theme">Array</div>
    <a href="#8">Значение массива</a>
    <a href="#15">reduceRight и создание объекта</a>
    <a href="#10">map</a>
    <a href="#13">Duplicate</a>

    <div class="theme">Прочее</div>
    <a href="#14">Приведение типов</a>
    <a href="#9">Всплытие 1</a>
    <a href="#11">Promise 1</a>
    <a href="#12">Promise 2</a>
    
<!-- 15 -->
</div>
<div id="content-wrapper">
<div id="menu-top"></div>
<div id="content">


<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2>Замыкания</h2>
<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="2">Сумма произвольного количества скобок</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->

<h4>Вариант #1</h4>
<pre><code class="js">
function sum() {
    let total = 0;
    let f = function (val) {
        if (typeof val === "undefined") {
            return total;
        }
        total += val;
        return f
    }
    return f.apply(null, arguments)
}

console.assert(sum() === 0);
console.assert(sum(1)(2)(3)() === 6);
console.assert(sum(10)(5)(5)(80)() === 100);
console.assert(typeof sum(100) === "function");
</code></pre>

<h4>Learn.Javascript.Ru</h4>
<pre><code class="js">
function sum(a) {
	var currentSum = a;
	function f(b) {
		currentSum += b;
		return f;
	}
	f.toString = function() {
		return currentSum;
	};
	return f;
}

console.log(sum(1)(2));             // 3
console.log(sum(5)(-1)(2));         // 6
console.log(sum(6)(-1)(-2)(-3));    // 0
console.log(sum(0)(1)(2)(3)(4)(5)); // 15
</code></pre>

<h4>Фиксированное окончание пустым значением</h4>
<pre><code class="js">
console.log(sum(1)(2)(3)()); // 6
function sum(arg) {
    let result = arg;
    let f = function(value) {
        if(value === indefined) {
            return result;
        } 
        result += value;
        return f;
    }
    return f;
}
</code></pre>

<h4>Добавление числа</h4>
<pre><code class="js">
console.log(sum(1)(2)(3) + 5); // 11

function sum(arg) {
    let result = arg;
    let f = function(value) {
    
        if(value === indefined) {
            return result;
        } 
        result += value;
        return f;
    }
    
    f.toString = function() {
        return result;
    }
    return f;
}
</code></pre>

<pre><code class="js">
// разбор
// let a = sum(1);
// let a1 = a(2);
// let a2 = a1(3);
// let result = 6;
// a2 = function(value) {
//         if(value === indefined) {
//             return result;
//         } 
//         result += value;
//         return f;
//     }
// a2.valueOf() + 5
</code></pre>



<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2>Объекты</h2>
<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="1">Обращение к функции как к объекту</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
let test = function() {
	console.log('hi from object!');
}
test.method = function () {
	console.log('hi from method!');
}
test.method()
test()
</code></pre>


<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="4">Singleton ES5</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
const Universe = (function(){
    let instance = null;
    
    function func() {
        if (!instance) {
            instance = this;
            this.size = 100;
        }
        
        return instance;
    }

    func.prototype.getSize = function() {
       return this.size;
    }

    func.prototype.setSize = function(size) {
       this.size = size;
    }
   
    return func;

})();

var a = new Universe();
var b = new Universe();

console.log(a === b); // должны получить true
console.log(a.getSize(), b.getSize()); // 100, 100
a.setSize(200);
console.log(a.getSize(), b.getSize()); // 200, 200
</code></pre>

<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="3">Singleton Class ES6</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
var instance = null;

class Singleton {
	constructor() {
		if(!instance){
			instance = this;
		}
		return instance;
	}
}
var a = new Singleton();
var b = new Singleton();
console.log(a === b); // true
</code></pre>

<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="5">Polyfill Object.create</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
const myObj1= {
    a: 1
};
const myObj2= {
    p: {value: 20},
    k: {value: 30}
};

function objectCreateobj(myObj1, myObj2) {
    function getPrototype() {}
    getPrototype.prototype = myObj1;
    
    let myProto = new getPrototype();
    
    for (key in myObj2) {
        myProto[key] = myObj2[key].value;
    }
    return myProto;
}

objectCreateobj(myObj1, myObj2);
</code></pre>


<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="7">Polyfill Object.create (JSR)</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->

<h4>Learn.Javascript.Ru</h4>

<h4>Исходный Object.create()</h4>
<pre><code class="js">
var objFirst = {
    name: 'Tony'
};
var objSecond = Object.create(objFirst); // => {} __proto__: name: "Tony"
</code></pre>

<h4>Полифил</h4>
<pre><code class="js">
var objFirst = {
    name: 'Tony'
};

//if (!Object.create) Object.create = inherit; // проверка поддержки Object.create
var objSecond = inherit(objFirst); // => {} __proto__: name: "Tony"

function inherit(proto) {
    function F() {}       // Создана новая функция F. Она ничего не делает с this, так что если вызвать new F, то получим пустой объект
    F.prototype = proto;  // Свойство F.prototype устанавливается в будущий прототип proto
    var object = new F(); // Результатом вызова new F будет пустой объект с __proto__ равным значению F.prototype
    return object;        // Получили пустой объект с заданным прототипом. Возвратим его
}
</code></pre>

<h4>Короткая запись</h4>
<pre><code class="js">
if (!Object.create) {
	Object.create = function(proto) {
		function F() {}
		F.prototype = proto;
		return new F;
	};
}
</code></pre>



<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="6">Prototype</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
function F () {
    this.a = 10;
}

F.prototype.foo = function () {
    return this.a;
}

const a = myNew(F);
console.log(a); // { a: 10, __proto__: { foo, constructor } }
console.log(a.foo()); // 10

function myNew(F) {
	let obj = Object.create(F.prototype);
	F.call(obj);
	return obj;
}
</code></pre>


<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<h2>Прочее</h2>
<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="8">Значение массива</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
var a = [];
function clear(arr) {
    arr.push(2);
    arr = null; 
}
clear(a);
console.log(a); // [2]
</code></pre>


<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="9">Всплытие 1</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
(function () {
    f(); // 2
    f = function () {
    console.log(1);
    };
})();

f(); // 1
var f = 10;
f(); // f is not a function
function f () {
    console.log(2);
}
</code></pre>


<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="10">map</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
const tweeps = [
    { name: 'Peter', age: 20 },
    { name: 'Mary', age: 32 }
];

// написать функцию prop
const str = 'Mentioned by ' + tweeps.map(prop('name')).join(', '); // 'Mentioned by Peter, Mary'
const agesStr = `They are ${tweeps.map(prop('age')).join(',')}` // 'They are 20, 32'

function prop(propName) {
    return function(obj) {
         return obj[propName]; 
    }
}
</code></pre>


<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="11">Promise 1</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
function delay(value) {
    return new Promise(function(resolve, reject){
       setTimeout(function(){
            resolve(100);
        }, value);
    });
}
delay(1000).then(value => console.log(‘Done with ’ + value)); // Done with 100
</code></pre>


<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="12">Promise 2</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
doSomething().then(function () {
    return doSomethingElse();
}).then(value => console.log(value)); // result doSomethingElse

doSomething().then(function () {
  doSomethingElse();
}).then(value => console.log(value)) // undefined

doSomething()
    .then(doSomethingElse()) // пропускается
    .then(value => console.log(value)); // result DoSomething

doSomething()
    .then(doSomethingElse)
    .then(value => console.log(value)); // result doSomethingElse 
</code></pre>


<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="13">Duplicate</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
console.log([1, 2, 3, 4].duplicate()) // [1, 2, 3, 4, 1, 2, 3, 4]
Array.prototype.duplicate = function() {
    return this.concat(this);
}

console.log([1, 2, 3, 4].duplicate()) // [1, 2, 3, 4, 1, 2, 3, 4]
Array.prototype.duplicate = function() {
    return [...this, ...this];
}
</code></pre>

<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="14">Приведение типов</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<pre><code class="js">
// && - первое значение
// || - последнее значение
console.log( false && '' );         // false  
console.log( false || '' );         // ''
console.log( '' || 'Yes' );         // 'Yes'
console.log( {} && 'Some' );        // 'Some'
console.log( {} || 'Some' );        // Object {}
console.log( {a: 10} && 'Some' );   // 'Some'
console.log( {a: 10} || 'Some' );   // Object { a: 10} 
console.log( 0 || true );           // true
console.log( null || 0 );           // 0
console.log( undefined && 0 );      // undefined
console.log( '' || 0 && true );     // 0
console.log( {} || 0 && true );     // Object {}
console.log( false || {} && true ); // true
</code></pre>


<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3 id="15">reduceRight и создание объекта</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<ul class="list-point">
    <li>Реализовать функцию, принимающую строку “a.b.c.d” и возвращающая объект со свойством объектом - a, со свойством объектом - b, со свойством объектом - с, со свойством d, равным null. Можно передать любую строку в указанном формате х.х.х.х.х.х…, и получить объект с вложенными объектами и завершающим null</li>
</ul>

<h4>reduceRight</h4>
<pre><code class="js">
function parse(str) {
    let arr = str.split('.');
    let obj = arr.reduceRight(function(result, current){
        return {
            [current]: result
        }
    }, null);
    return obj;
}
parse('a.b.c.d');
</code></pre>

<h4>reduce</h4>
<pre><code class="js">
function parse(str) {
    let arr = str.split('.').reverse();
    let obj = arr.reduce(function(result, current){
        return {
            [current]: result
        }
    }, null);
    return obj;
}
parse('a.b.c.d');
</code></pre>





</div>
</div>
</div>
	<div id="preloader"></div>
    <script src="libraries/jquery.js"></script>
	<script src="libraries/highlight/highlight.pack.js"></script>
	<script src="js/main.js"></script>
	<script src="module/preloader/preloader.js"></script>
</body>
</html>
