<h2>CORS</h2>

<ul class="list-point">
	<li><bg-define>Cross-origin resource sharing</bg-define> (CORS «совместное использование ресурсов между разными источниками») - технология современных браузеров, которая позволяет предоставить веб-странице доступ к ресурсам другого домена</li>
</ul>

<!------------------------------------------------------>
<h3>Кросс-доменные запросы</h3>
<!------------------------------------------------------>
<ul class="list-point">
	<li>Запрос обязательно должен быть асинхронным</li>
</ul>

<ul class="list-point">
	<li>1. В кросс-доменный запрос браузер автоматически добавляет заголовок <u>Origin</u>, содержащий домен, с которого осуществлён запрос</li>
	<li>2. Если сервер разрешает кросс-доменный запрос с этого домена он должен добавить к ответу заголовок <u>Access-Control-Allow-Origin</u>, содержащий домен запроса или звёздочку <u>*</u>. Только при наличии такого заголовка в ответе – браузер сочтёт запрос успешным, а иначе JavaScript получит ошибку</li>
	<li>3. Чтобы JavaScript мог прочитать HTTP-заголовок ответа, сервер должен указать его имя в <u>Access-Control-Expose-Headers</u></li>
</ul>

<h4>Простой метод GET, POST, HEAD</h4>

<p>Запрос с домена http://test1.ru</p>
<pre><code class="js">
var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://test2.ru/script.php', true);
xhr.onload = function() {
    console.log(this.responseText);
}
xhr.onerror = function() {
    console.log(this.status);
}
xhr.send();
</code></pre>

<p>Сервер http://test2.ru</p>
<pre><code class="js">
&lt;?php
    header('<bg-code>Access-Control-Allow-Origin</bg-code>: http://test1.ru'); // разрешить доступ домену http://test1.ru
    header('Access-Control-Allow-Origin: *');               // разрешить доступ любому домену
?&gt;
</code></pre>

<h4>Передавать куки и HTTP-авторизацию</h4>
<pre><code class="js">
xhr.withCredentials = true;
</code></pre>
<pre><code class="js">
&lt;?php
	header('Access-Control-Allow-Origin: домен');    // Использование звёздочки * запрещено
	header('<bg-code>Access-Control-Allow-Credentials</bg-code>: true');
?&gt;
</code></pre>
